<div class="entry">

	<% if @post.title %>
	    <% if @post.published_at %>
	    <h2><a href="<%= short_url(:slug => @post.slug) %>"><%= @post.title %></a></h2>
        <% else %>
	    <h2><%= @post.title %></h2>
	    <% end %>
	<% end %>

	<p id="notice"><%= notice %></p>

	<div class="image"><%= image_tag @post.image.url(:large) %></div>
	
	<%= form_for(@post) do |f| %>
	  <% if @post.errors.any? %>
	    <div id="error_explanation">
	      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

	      <ul>
	      <% @post.errors.full_messages.each do |msg| %>
	        <li><%= msg %></li>
	      <% end %>
	      </ul>
	    </div>
	  <% end %>

	  <div class="field">
	    <%= f.label :title %>
	    <%= f.text_field :title %>
	  </div>

	  <div class="field">
	    <%= f.label :tag_list %>
	    <%= f.text_field :tag_list, :autocapitalize => "off" %> <a class="cloud-toggle">Show tag cloud</a>
	  </div>

	  <div class="field">
	    <%= f.label :source_title %>
	    <%= f.text_field :source_title %>
	  </div>

	  <div class="field">
	    <%= f.label :source_url %>
	    <%= f.text_field :source_url %>
	  </div>

	  <ul class="tag-cloud" style="display: none;">
          <% tag_cloud(@tags, %w()) do |tag, css_class| %>
                <li><a class="<%= css_class %>"><%= tag.name %></a></li>
          <% end %>
      </ul>

<!--    <% if @post.published_at %>
        <div class="field">
            <label>Published at:</label>
            <input disabled="disabled" type="text" value="<%= @post.published_at %>">
        </div>

        <div class="field">
            <label>Slug:</label>
            <input disabled="disabled" type="text" value="<%= @post.slug %>">
        </div>
    <% end %>
 -->
	  <div class="actions">
	    <%= f.submit 'Save' %>
	  </div>
	<% end %>
	
	<% if !@post.published_at %>
		<% if @post.publishable %>
			<%= form_for @post, :url => { :action => "publish" } do |f| %>
			  <% if @post.errors.any? %>
			    <div id="error_explanation">
			      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

			      <ul>
			      <% @post.errors.full_messages.each do |msg| %>
			        <li><%= msg %></li>
			      <% end %>
			      </ul>
			    </div>
			  <% end %>
			  <div class="actions">
			    <%= f.submit "Publish" %>
			  </div>
			<% end %>
		<% end %>
	<% end %>
	
	<!-- <%= link_to 'Destroy', @post, confirm: 'Are you sure?', method: :delete %> -->
	
</div>
